<div class="gerer-produits-container">
  <div class="header">
    <h2>Products</h2>
    <div class="header-actions">
      <button class="import-export-btn">
        <i class="icon-import-export"></i>
        IMPORTER / EXPORTER
      </button>
    </div>
  </div>
  
  <div class="filters-section">
    <div class="status-filters">
      <span class="status-label">STATUT:</span>
      <div class="filter-buttons">
        <button
          class="filter-btn"
          [class.active]="selectedStatus === 'tous'"
          (click)="filterByStatus('tous')">
          Tous
        </button>
        <button
          class="filter-btn"
          [class.active]="selectedStatus === 'attente'"
          (click)="filterByStatus('attente')">
          En attente de v√©rification
        </button>
        <button
          class="filter-btn"
          [class.active]="selectedStatus === 'pas-pret'"
          (click)="filterByStatus('pas-pret')">
          Pas pr√™t pour la v√©rification
        </button>
        <button
          class="filter-btn"
          [class.active]="selectedStatus === 'approuve'"
          (click)="filterByStatus('approuve')">
          Approuv√©
        </button>
        <button
          class="filter-btn"
          [class.active]="selectedStatus === 'rejete'"
          (click)="filterByStatus('rejete')">
          Rejet√©
        </button>
        <button
          class="filter-btn"
          [class.active]="selectedStatus === 'actif'"
          (click)="filterByStatus('actif')">
          Actif
        </button>
        <button
          class="filter-btn"
          [class.active]="selectedStatus === 'inactif'"
          (click)="filterByStatus('inactif')">
          Inactif
        </button>
      </div>
    </div>
  </div>

  <!-- Loading spinner -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Chargement...</span>
    </div>
    <p class="loading-text">Chargement des produits...</p>
  </div>

  <div class="table-container" *ngIf="!isLoading">
    <table class="products-table">
      <thead>
        <tr>
          <th>Image</th>
          <th>Nom</th>
          <th>Prix</th>
          <th>Prix de vente</th>
          <th>Quantit√©
            <i class="info-icon">‚ìò</i>
          </th>
          <th>Visible</th>
          <th>√âtat</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngIf="filteredProducts.length === 0">
          <td colspan="8" class="no-results">
            Pas de r√©sultats trouv√©s !
          </td>
        </tr>
        <tr *ngFor="let product of filteredProducts">
          <td>
            <div class="image-container">
              <!-- Afficher l'image si elle existe -->
              <div *ngIf="getImageCount(product) > 0">
                <img 
                  [src]="getProductImage(product, getCurrentImageIndex(product.id!))" 
                  [alt]="product.nom"
                  class="product-image"
                />
                
                <!-- Fl√®ches de navigation si plusieurs images -->
                <div class="image-navigation" *ngIf="hasMultipleImages(product)">
                  <button 
                    class="nav-btn prev-btn" 
                    (click)="previousImage(product, $event)"
                    title="Image pr√©c√©dente">
                    ‚óÄ
                  </button>
                  <span class="image-counter">
                    {{ getCurrentImageIndex(product.id!) + 1 }} / {{ getImageCount(product) }}
                  </span>
                  <button 
                    class="nav-btn next-btn" 
                    (click)="nextImage(product, $event)"
                    title="Image suivante">
                    ‚ñ∂
                  </button>
                </div>
              </div>
              
              <!-- Indicateur si aucune image -->
              <div class="no-image-indicator" *ngIf="getImageCount(product) === 0">
                üì∑ Pas d'image
              </div>
            </div>
          </td>
          <td>{{ product.nom }}</td>
          <td>{{ product.prix | currency:'EUR':'symbol':'1.2-2' }}</td>
          <td>{{ product.prix * 1.2 | currency:'EUR':'symbol':'1.2-2' }}</td>
          <td>
            <span [ngClass]="getStockStatus(product.quantite).class">
              {{ product.quantite }}
            </span>
          </td>
          <td>
            <span 
              *ngIf="product.quantite > 0" 
              class="status-badge visible">
              Visible
            </span>
            <span 
              *ngIf="product.quantite === 0" 
              class="status-badge invisible">
              Invisible
            </span>
          </td>
          <td>
            <span 
              class="etat-badge" 
              [ngClass]="getEtatClass(product.etat)">
              {{ getEtatLabel(product.etat) }}
            </span>
          </td>
          <td>
            <div class="actions">
              <button class="action-btn edit-btn" (click)="editProduct(product)" title="Modifier">
                ‚úèÔ∏è
              </button>
              <button class="action-btn view-btn" (click)="viewProduct(product)" title="Voir">
                üëÅÔ∏è
              </button>
              <button class="action-btn delete-btn" (click)="deleteProduct(product)" title="Supprimer">
                üóëÔ∏è
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>