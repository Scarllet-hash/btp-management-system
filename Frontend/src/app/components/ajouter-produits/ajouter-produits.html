<div class="ajouter-produits-container">
  <!-- Header avec navigation -->
  <div class="header">
    <div class="breadcrumb">
      <span class="breadcrumb-item">Products</span>
      <span class="breadcrumb-separator">></span>
      <span class="breadcrumb-item">Add</span>
      <span class="breadcrumb-separator">></span>
      <span class="breadcrumb-item active">Single Product</span>
    </div>
  </div>

  <!-- Titre avec bouton retour -->
  <div class="page-title">
    <button class="back-btn" (click)="goBack()">
      ← Ajouter des produits
    </button>
  </div>

  <!-- Timeline horizontale -->
  <div class="timeline-container">
    <div class="timeline-step" [class.active]="currentStep === 1" [class.completed]="currentStep > 1">
      <div class="timeline-icon">
        <span>Information produit</span>
      </div>
      <div class="timeline-line"></div>
    </div>
    <div class="timeline-step" [class.active]="currentStep === 2" [class.disabled]="currentStep < 2">
      <div class="timeline-icon">
        <span>Spécification de produit</span>
      </div>
    </div>
  </div>

  <!-- Contenu principal -->
  <div class="main-content">
    <!-- Formulaire principal -->
    <div class="form-container">
      <h2 *ngIf="currentStep === 1">Information produit</h2>
      <h2 *ngIf="currentStep === 2">Spécification de produit</h2>

      <!-- Upload d'images - toujours visible -->
      <div class="images-section">
        <div class="image-upload-grid">
          <div class="image-upload main-image" 
               [class.has-image]="selectedImages[0]">
            <input type="file" 
                   accept="image/*" 
                   (change)="onImageSelect($event, 0)"
                   id="image-0"
                   style="display: none;">
            <label for="image-0" class="upload-label">
              <div *ngIf="!selectedImages[0]" class="upload-placeholder">
                <span class="plus-icon">+</span>
                <span class="upload-text">Image principale</span>
              </div>
              <img *ngIf="selectedImages[0]" [src]="selectedImages[0]" class="uploaded-image">
            </label>
            <button *ngIf="selectedImages[0]" 
                    class="remove-image" 
                    (click)="removeImage(0)">×</button>
          </div>

          <div class="image-upload" 
               *ngFor="let image of [1,2,3,4,5,6]; let i = index"
               [class.has-image]="selectedImages[i+1]">
            <input type="file" 
                   accept="image/*" 
                   (change)="onImageSelect($event, i+1)"
                   [id]="'image-' + (i+1)"
                   style="display: none;">
            <label [for]="'image-' + (i+1)" class="upload-label">
              <div *ngIf="!selectedImages[i+1]" class="upload-placeholder">
                <span class="plus-icon">+</span>
                <span class="upload-text">Image</span>
              </div>
              <img *ngIf="selectedImages[i+1]" [src]="selectedImages[i+1]" class="uploaded-image">
            </label>
            <button *ngIf="selectedImages[i+1]" 
                    class="remove-image" 
                    (click)="removeImage(i+1)">×</button>
          </div>
        </div>
        <p class="image-info">
          L'image doit être comprise entre 500 × 500 et 2 000 × 2 000 pixels. 
          Les fonds blancs sont recommandés. Aucun filigrane. Taille maximale de l'image 2 Mo.
        </p>
      </div>

      <!-- Formulaire de base - toujours visible -->
      <div class="form-row">
        <div class="form-group">
          <label for="nom">Nom <span class="required">*</span></label>
          <input type="text" 
                 id="nom"
                 [(ngModel)]="product.nom"
                 (ngModelChange)="onNameChange()"
                 placeholder='Ex.: "Casque Sans Fil - À Réduction De Bruit - NM520 - Noir"'
                 class="form-input">
        </div>

        <div class="form-group">
          <label for="categorie">Catégorie <span class="required">*</span></label>
          <select id="categorie" 
                  [(ngModel)]="product.categorie"
                  (change)="onCategoryChange()"
                  class="form-select">
            <option value="">Catégorie</option>
            <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
          </select>
        </div>
      </div>

      <!-- Formulaire détaillé - apparaît automatiquement quand nom ET catégorie remplis -->
      <div *ngIf="showForm" class="detailed-form">
        <div class="form-row">
          <div class="form-group">
            <label for="prix">Prix <span class="required">*</span></label>
            <input type="number" 
                   id="prix"
                   [(ngModel)]="product.prix"
                   placeholder="0.00"
                   class="form-input"
                   min="0"
                   step="0.01">
          </div>

          <div class="form-group">
            <label for="quantite">Quantité <span class="required">*</span></label>
            <input type="number" 
                   id="quantite"
                   [(ngModel)]="product.quantite"
                   placeholder="0"
                   class="form-input"
                   min="0">
          </div>
        </div>

        <div class="form-group">
          <label for="etat">État <span class="required">*</span></label>
          <select id="etat" 
                  [(ngModel)]="product.etat"
                  class="form-select">
            <option value="">Sélectionnez l'état</option>
            <option *ngFor="let etat of etats" [value]="etat.value">{{ etat.label }}</option>
          </select>
        </div>

        <div class="form-group">
          <label for="description">Description du produit <span class="required">*</span></label>
          <textarea id="description" 
                    [(ngModel)]="product.description"
                    placeholder="- Inclure uniquement des informations liées au produit. - Écrire de manière claire et concise. - Assurez-vous que la description correspond aux images de votre produit."
                    class="form-textarea"
                    rows="6"></textarea>
        </div>

        <!-- Bouton soumettre -->
        <div class="form-actions">
          <button class="submit-btn" 
                  (click)="onSubmit()"
                  [disabled]="!isFormValid()">
            Ajouter le produit
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal de succès -->
<div *ngIf="showSuccessModal" class="modal-overlay" (click)="closeSuccessModal()">
  <div class="success-modal" (click)="$event.stopPropagation()">
    <div class="success-icon">
      <div class="checkmark">✓</div>
    </div>
    <h3>Produit ajouté avec succès!</h3>
    
    <div class="modal-actions">
      <button class="btn-primary" (click)="ajouterNouveauProduit()">
        AJOUTER UN NOUVEAU PRODUIT
      </button>
      <button class="btn-secondary" (click)="accederGestion()">
        ACCÉDER À LA SECTION GESTION DES PRODUITS
      </button>
    </div>
  </div>
</div>

